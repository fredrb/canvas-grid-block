function getMousePosition(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}var CanvasControll=function(a){this.grid=a,this.canvas=document.getElementById("grid")};CanvasControll.prototype.drawCellAtPosition=function(a,b,c,d,e){var f=this.canvas.getContext("2d");f.fillStyle=e.color,f.fillRect(a,b,c,d)},CanvasControll.prototype.eraseCellAtPosition=function(a,b,c,d){var e=this.canvas.getContext("2d");e.clearRect(a,b,c,d)},CanvasControll.prototype.attachClickListener=function(a){this.canvas.addEventListener("click",a)};var Cell=function(a,b){this.x=a,this.y=b,this.content=null},Grid=function(a,b,c,d){this.canvas=new CanvasControll(this),this.erased=0,this.CELL_WIDTH=c,this.CELL_HEIGHT=d,this._initailizeGrid(a,b)};Grid.prototype._initailizeGrid=function(a,b){this.unfilledCells=[],this.filledCells=[],this.map=[];for(var c=0;a>c;c++){this.map.push([]);for(var d=0;b>d;d++){var e=new Cell(c,d);this.map[c].push(e),this.unfilledCells.push(e)}}this.canvas.attachClickListener(this.onCanvasClick)},Grid.prototype.drawCellAt=function(a,b,c){var d=new c,e=this.map[a][b];if(null!=e.content)throw new Error("Cell "+[a,b]+" not empty");this.unfilledCells.splice(this.unfilledCells.indexOf(e),1),e.content=d,this.filledCells.push(e),this.canvas.drawCellAtPosition(a*this.CELL_WIDTH,b*this.CELL_HEIGHT,this.CELL_WIDTH,this.CELL_HEIGHT,d)},Grid.prototype.eraseUglyCoordinatesCellAt=function(a,b){var c=Math.floor(a/this.CELL_WIDTH),d=Math.floor(b/this.CELL_HEIGHT);this.eraseCellAt(c,d)},Grid.prototype.eraseCellAt=function(a,b){var c=this.map[a][b];if(null==c.content)throw new Error("Cell already empty");this.filledCells.splice(this.filledCells.indexOf(c),1),c.content.destroy(),c.content=null,this.unfilledCells.push(c),this.canvas.eraseCellAtPosition(a*this.CELL_WIDTH,b*this.CELL_HEIGHT,this.CELL_WIDTH,this.CELL_HEIGHT)},Grid.prototype._getRandomUnfilledCell=function(){var a=Math.floor(Math.random()*this.unfilledCells.length);return this.unfilledCells[a]},Grid.prototype._getRandomFilledCell=function(){var a=Math.floor(Math.random()*this.filledCells.length);return this.filledCells[a]},Grid.prototype.onCanvasClick=function(a){var b=getMousePosition(this,a),c=!0;try{grid.eraseUglyCoordinatesCellAt(b.x,b.y)}catch(d){if("Cell already empty"!=d.message)throw d;c=!1}c&&(this.erased+=1)},Grid.prototype.eraseRandomCell=function(){var a=this._getRandomFilledCell();this.eraseCellAt(a.x,a.y)},Grid.prototype.initAutoDraw=function(a,b){var c=this;setTimeout(function(){if(c.unfilledCells.length>0){var d=b[Math.floor(Math.random()*b.length)],e=c._getRandomUnfilledCell();c.drawCellAt(e.x,e.y,d)}c.initAutoDraw(a,b)},a)};
//# sourceMappingURL=grid.min.js.map